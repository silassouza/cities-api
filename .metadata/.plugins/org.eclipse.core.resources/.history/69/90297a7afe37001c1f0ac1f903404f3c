package com.example.citiesapi.utils

import javax.persistence.AttributeConverter
import javax.persistence.Converter

import com.fasterxml.jackson.core.type.TypeReference
import com.fasterxml.jackson.databind.ObjectMapper

@Converter
class JsonConverter implements AttributeConverter<Collection<Integer>, String> {
	
	@Override
	def String convertToDatabaseColumn(Set<Integer> attribute) {
		ObjectMapper objectMapper = new ObjectMapper()
		objectMapper.writeValueAsString(attribute)
	}

	@Override
	def Set<Integer> convertToEntityAttribute(String data) {
		ObjectMapper objectMapper = new ObjectMapper()
		objectMapper.readValue(data, new TypeReference<Collection<Integer>>(){})
	}
}
